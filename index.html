<!-- <html>

<head>
  <title>Instascan – Demo</title>
  <link rel="icon" type="image/png" href="https://schmich.github.io/instascan/favicon.png">
  <link rel="stylesheet" href="https://schmich.github.io/instascan/style.css">
  <script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/webrtc-adapter/3.3.3/adapter.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.1.10/vue.min.js"></script>
  <script type="text/javascript" src="https://rawgit.com/schmich/instascan-builds/master/instascan.min.js"></script>
</head>

<body>
  <a href="https://github.com/schmich/instascan"><img
      style="position: absolute; top: 0; right: 0; border: 0; z-index: 1"
      src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67"
      alt="Fork me on GitHub"
      data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a>
  <div id="app">
    <div class="sidebar">
      <section class="cameras">
        <h2>Cameras</h2>
        <ul>
          <li class="empty">No cameras found</li>
        </ul>
      </section>
      <section class="scans">
        <h2>Scans</h2>
        <ul>
          <li class="empty">No scans yet</li>
        </ul>
        <ul></ul>
      </section>
    </div>
    <div class="preview-container"><video id="preview" autoplay="autoplay" class="inactive"
        style="transform: scaleX(-1);"></video></div>
  </div>
  <script type="text/javascript">
    let scanner = new Instascan.Scanner({ video: document.getElementById('preview') });
    scanner.addListener('scan', function (content) {
      console.log(content);
      alert(content);
    });
    Instascan.Camera.getCameras().then(function (cameras) {
      console.log(cameras.length);
      alert(cameras.length);
      if (cameras.length > 0) {
        if (cameras.length > 1) {
          alert("2");
          scanner.start(cameras[1]);
        } else {
          alert("1");
          scanner.start(cameras[0]);
        }
      } else {
        console.error('No cameras found.');
      }
    }).catch(function (e) {
      console.error(e);
    });
  </script>
</body>

</html> -->

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <div id="reader" width="600px"> </div>
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
  <script type="text/javascript">
    // This method will trigger user permissions
    Html5Qrcode.getCameras().then(devices => {
      if (devices && devices.length) {
        var cameraId = devices[0].id;
        const html5QrCode = new Html5Qrcode("reader");
        const qrCodeSuccessCallback = (decodedText, decodedResult) => {
          alert(decodedText);// 這裡已經可以正確彈出掃描結果，但點按無法跳轉
          setTimeout(location.href=decodedText,1000);
        };
        const config = {
          fps: 25,
          qrbox: {
            width: 350,
            height: 350
          }
        };
        html5QrCode.start({
          facingMode: "environment"
        }, config, qrCodeSuccessCallback);
      }
    }).catch(err => {
      // handle err
    });
  </script>
</body>

</html>
